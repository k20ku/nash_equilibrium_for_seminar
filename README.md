# nash_equilibrium_for_seminar

## 概要

先輩の卒論をレビューしていて，煩雑な計算の検証を自動化したくて導入しました．
自宅が計算用紙の山になっていると聞き，助けてあげたいという想いで頼まれてもいないのに，短期間で作りました．
正直なところJavaやKotlin, Rust, TypeScript のような静的型付け言語のほうがプログラミング経験の浅い私としては
書きやすいと思ってしまうのですが，科学技術計算のライブラリはPythonの他にこれほどの知名度のある言語で並ぶものはないと
思っておりますので，Pythonで開発し続けるつもりです．

## 気を付けている点

1. 使いやすいように気を付けています．
   - `MarketData` は必要なデータだけで初期化できる
   - `NewConditions`クラスから卒論に必要なものだけを`MarketData`で計算できるように
2. 保守や開発がしやすいように心がけています
   - スパゲッティ化する前にクラスや関数でカプセル化にしています
   - 副作用や参照透過を意識しています．そのため，現在暗黙的な状態を持ったり破壊的な変更をしている実装はありません．
3. pythonらしいコードを勉強しながら，手探りで続けています．

## 使い方

### ナッシュ均衡の候補を求める

`nashEquilibria.py` の `MarketData` をインスタンス化して，`solveEq` で均衡を求められます．

```python
>>> OffOn = MarketData(lambda a,b: ((a-b+2)**2)/8,'off','on')
>>> OffOn.solveEq()
# もともとは動いていたのですが
# 現在はエラーが出るようになっています
# スパゲッティコードになっておりそのままでは改修が困難です．
# `game.py` などで外堀を固めながら順次改修しています．

```

将来的には以下のようにしたいです．

```python
>>> from salesStrategy import SalesStrategy as ss
>>> from newConditions import NewConditions as nc
>>> OffOn1=MarketData(lambda a,b: ((a-b+2)**2)/8, ss.OFF, ss.ON)
>>> OffOn2=MarketData(nc.CHAP3_1) # OffOn1と同じこと
>>> OffOn2.solveEq()
```

### 数値的な計算を行う

`numpy` 関数化するsympyの `lambdify` 関数がどうやら内部で`eval`関数を使っているので注意が必要そうです．
結構後回しになりそうです．

### n人ゲームの純粋戦略ナッシュ均衡を解く

割とこれからも需要のありそうな一般的な用途として使える機能です．`game.py` が担ってくれています．
現在 `nashEquilibria.py` がスパゲッティ化のため改修が困難になっているのを打開するのに開発しています．
テスト駆動を取り入れているのでかなり精度が高くなっています．

## 謝辞

手探りの開発のため名前がコロコロ変わったり，いきなり仕様が変わることが多いです．
Gitでのチーム開発経験がなく手探りなので，GitFlowがなっていません．どんどん勉強して直していく所存です．
JavaやKotlinなどの静的型付け言語と違い，型による制約が付けづらく思った通りにかけていないという印象です．
余り型で縛るのはPythonらしくないとは思うのですが，最近の公式ライブラリを見る限りそこそこ型アノテーションをつけているので，
そんなに悪くはないのかなとも．
